<!DOCTYPE html>
<html lang="de" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanup Gruppe Darmstadt - Gemeinsam f√ºr eine saubere Umwelt</title>
    <meta name="description" content="Freiwillige Cleanup-Aktionen in Darmstadt. Jeden Sonntag gemeinsam die Natur vom M√ºll befreien. Mach mit ‚Äì ohne Verpflichtung, ohne Vorkenntnisse!">
    <meta name="keywords" content="Cleanup, Darmstadt, Umweltschutz, M√ºllsammeln, Freiwillige, Naturschutz">
    <meta name="author" content="Cleanup Gruppe Darmstadt">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Cleanup Gruppe Darmstadt">
    <meta property="og:description" content="Freiwillige Cleanup-Aktionen in Darmstadt. Gemeinsam f√ºr eine saubere Umwelt!">
    <meta property="og:image" content="https://cleanup-darmstadt.de/images/cleanup_darmstadt_logo.png">
    <meta property="og:url" content="https://cleanup-darmstadt.de">
    
    <link rel="icon" type="image/png" href="images/cleanup_darmstadt.png">
    
    <!-- Tailwind CSS (lokal) -->
    <script src="tailwind.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#28a745'
                    }
                }
            }
        }
    </script>
    
    <!-- Leaflet CSS (lokal) -->
    <link rel="stylesheet" href="leaflet.css" />
    <!-- Leaflet MarkerCluster CSS (lokal) -->
    <link rel="stylesheet" href="MarkerCluster.css" />
    <link rel="stylesheet" href="MarkerCluster.Default.css" />
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between py-4">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <img src="images/cleanup_darmstadt_logo.png" alt="Cleanup Darmstadt Logo" class="h-12">
                    <div>
                        <h1 class="text-xl font-bold text-primary">Cleanup Darmstadt</h1>
                        <p class="text-xs text-gray-600">Gemeinsam f√ºr eine saubere Umwelt</p>
                    </div>
                </div>
                
                <!-- Navigation -->
                <nav class="hidden md:flex gap-6">
                    <a href="#about" class="text-gray-700 hover:text-primary transition">√úber uns</a>
                    <a href="#next-events" class="text-gray-700 hover:text-primary transition">Termine</a>
                    <a href="#map-section" class="text-gray-700 hover:text-primary transition">Karte</a>
                    <a href="#contact" class="text-gray-700 hover:text-primary transition">Kontakt</a>
                </nav>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="md:hidden text-gray-700 hover:text-primary">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Mobile Navigation -->
            <nav id="mobile-menu" class="hidden md:hidden pb-4 flex-col gap-3">
                <a href="#about" class="block text-gray-700 hover:text-primary transition py-2">√úber uns</a>
                <a href="#next-events" class="block text-gray-700 hover:text-primary transition py-2">Termine</a>
                <a href="#map-section" class="block text-gray-700 hover:text-primary transition py-2">Karte</a>
                <a href="#contact" class="block text-gray-700 hover:text-primary transition py-2">Kontakt</a>
            </nav>
        </div>
    </header>
    
    <div class="container mx-auto px-4 py-8">
        <!-- About Section -->
        <section id="about" class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold text-primary border-b-4 border-primary pb-2 mb-6 text-center">Wer wir sind</h2>
            <div class="max-w-3xl mx-auto text-gray-700 space-y-5">
                <p class="text-xl text-center font-medium text-primary">
                    Gemeinsam anpacken statt nur reden ‚Äì das ist unser Motto!
                </p>
                <p class="text-lg">
                    Wir sind eine Gruppe von <strong>Freiwilligen aus Darmstadt</strong>, die keine Lust mehr haben,
                    tatenlos zuzusehen, wie unsere sch√∂ne Natur verm√ºllt wird. Stattdessen krempeln wir die √Ñrmel hoch
                    und r√§umen auf ‚Äì ganz unkompliziert und ohne gro√ües Tamtam.
                </p>
                <p>
                    <strong>Jeden zweiten bis vierten Sonntag</strong> starten wir eine neue Cleanup-Aktion.
                    Wo genau? Das besprechen wir gemeinsam ‚Äì flexibel und nach Bedarf. Dabei geht es nicht nur
                    darum, M√ºlls√§cke zu f√ºllen. Es geht darum, <strong>zusammen etwas Sinnvolles zu tun</strong>,
                    nette Menschen kennenzulernen und die Gewissheit zu haben: Heute haben wir wirklich etwas bewegt!
                </p>
                <p>
                    Nach jedem Cleanup melden wir den gesammelten M√ºll der Stadt Darmstadt. Der
                    <strong>EAD</strong> k√ºmmert sich dann um die fachgerechte Entsorgung ‚Äì so bleibt unser
                    Einsatz nachhaltig und professionell.
                </p>
                <div class="bg-green-50 border-l-4 border-green-500 p-4 mt-6">
                    <p class="text-green-800 font-medium">
                        üíö Du brauchst keine Vorkenntnisse, keine spezielle Ausr√ºstung und keine langfristige Verpflichtung.
                        Komm einfach vorbei, wenn es bei dir passt ‚Äì jede helfende Hand z√§hlt!
                    </p>
                </div>
            </div>
        </section>

        <!-- Next Events Section -->
        <section id="next-events" class="bg-gray-800 text-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold mb-6 text-center">üóìÔ∏è N√§chste Termine</h2>
            <div class="max-w-3xl mx-auto">
                <div id="events-list" class="space-y-4 mb-6"></div>
                
                <div class="bg-white/10 rounded-lg p-4 italic">
                    <p class="text-center">
                        <strong>üåßÔ∏è Wichtiger Hinweis:</strong> Bei (starkem) Regen entf√§llt das Cleanup.
                        Dies wird am Vormittag kurzfristig entschieden.
                    </p>
                </div>
            </div>
        </section>

        <!-- Map & List Section -->
        <section id="map-section" class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <!-- Tabs -->
            <div class="flex border-b border-gray-200 mb-6">
                <button id="tab-map" class="tab-button active px-6 py-3 font-semibold text-primary border-b-2 border-primary transition">
                    üó∫Ô∏è Kartenansicht
                </button>
                <button id="tab-list" class="tab-button px-6 py-3 font-semibold text-gray-600 border-b-2 border-transparent hover:text-primary transition">
                    üìã Listenansicht
                </button>
            </div>
            
            <!-- Map View -->
            <div id="view-map" class="tab-content">
                <!-- Map Container -->
                <div id="map" class="h-[400px] md:h-[600px] lg:h-[800px] rounded-lg shadow-md mb-4 relative z-0"></div>
                
                <!-- Map Legend -->
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-bold mb-3">Legende:</h4>
                    <div class="flex flex-col gap-2">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 bg-green-500 rounded-full text-white flex items-center justify-center font-bold shadow">5</div>
                            <span>Cluster mit mehreren durchgef√ºhrten Aktionen (Zahl zeigt Anzahl)</span>
                        </div>
                        <div class="flex items-center gap-3">
                            <svg width="25" height="41" viewBox="0 0 25 41" class="flex-shrink-0">
                                <path fill="#28a745" d="M12.5 0C5.6 0 0 5.6 0 12.5c0 8.4 12.5 28.5 12.5 28.5S25 20.9 25 12.5C25 5.6 19.4 0 12.5 0z"/>
                                <circle cx="12.5" cy="12.5" r="5" fill="white"/>
                            </svg>
                            <span>Einzelne durchgef√ºhrte Cleanup-Aktion</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- List View -->
            <div id="view-list" class="tab-content hidden">
                <div id="cleanup-list" class="space-y-4 max-h-[600px] md:max-h-[800px] overflow-y-auto pr-2">
                    <!-- List items will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Info Section -->
        <section class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">üéí Was du mitbringen solltest</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Feste Schuhe</li>
                        <li>Wetterfeste Kleidung</li>
                        <li>Gartenhandschuhe (falls vorhanden)</li>
                        <li>M√ºllzange (falls vorhanden)</li>
                        <li>ggf. Warnweste</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">‚úÖ Was wir bereitstellen</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>M√ºlls√§cke</li>
                        <li>Handschuhe (begrenzte Anzahl)</li>
                        <li>Cleanup Darmstadt Info Sticker</li>
                        <li>Organisation und Koordination</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ F√ºr Familien geeignet</h4>
                    <p class="text-gray-700">
                        Unsere Cleanup-Aktionen sind familienfreundlich. Kinder sind willkommen und lernen
                        spielerisch den verantwortungsvollen Umgang mit der Umwelt.
                    </p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">‚è±Ô∏è Zeitlicher Ablauf</h4>
                    <p class="text-gray-700">
                        Unsere Aktionen dauern in der Regel 1,5 Stunden. Du kannst jederzeit kommen und gehen,
                        wie es deine Zeit erlaubt.
                    </p>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold text-primary border-b-4 border-primary pb-2 mb-6 text-center">Kontakt</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üìò Facebook-Gruppe</h3>
                    <p class="mb-4 text-gray-700">Termine und Austausch</p>
                    <a href="https://www.facebook.com/groups/162624218009992" target="_blank"
                       class="text-primary font-semibold hover:underline">
                        Zur Facebook-Gruppe
                    </a>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üì± WhatsApp-Gruppe</h3>
                    <p class="mb-4 text-gray-700">Schnelle Absprachen</p>
                    Beitritt auf Anfrage
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üìß E-Mail</h3>
                    <p class="mb-4 text-gray-700">Bei Fragen</p>
                    birgit [at] cleanup-darmstadt.de
                </div>
            </div>
        </section>
    </div>

    <!-- Leaflet JS (lokal) -->
    <script src="leaflet.js"></script>
    <!-- Leaflet MarkerCluster JS (lokal) -->
    <script src="leaflet.markercluster.js"></script>
    
    <!-- Map Script -->
    <script>
        // Initialize map centered on Darmstadt
        const map = L.map('map').setView([49.8728, 8.6512], 12);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);

        // Define cleanup locations with coordinates
        const cleanupLocations = [
            {
                name: 'Rudolf-M√ºller-Anlage',
                lat: 49.8718263919592,
                lng: 8.667639001983256,
                description: 'am 25.01.2026'
            },
            {
                name: 'Ostbahnhof',
                lat: 49.874938,
                lng: 8.673340,
                description: 'am 04.01.2026',
                image: 'aktionen/2026-01-04.jpeg'
            },
            {
                name: 'B√ºrgerpark Parkplatz',
                lat: 49.888260847276264,
                lng: 8.660895854647498,
                description: 'am 14.12.2025',
                image: 'aktionen/2025-12-14.jpeg'
            },
            {
                name: '',
                lat: 49.8953277777778,
                lng: 8.63760555555556,
                description: 'am 24.03.2024',
                image: 'aktionen/2024-03-24.jpeg'
            },
            {
                name: '',
                lat: 49.8882555555556,
                lng: 8.66094722222222,
                description: 'am 14.07.2024',
                image: 'aktionen/2024-07-14.jpeg'
            },
            {
                name: '',
                lat: 49.8749277777778,
                lng: 8.67290277777778,
                description: 'am 13.10.2024',
                image: 'aktionen/2024-10-13.jpeg'
            },
            {
                name: '',
                lat: 49.8921555555556,
                lng: 8.70035277777778,
                description: 'am 19.01.2025',
                image: 'aktionen/2025-01-19.jpeg'
            },
            {
                name: '',
                lat: 49.8440777777778,
                lng: 8.64888333333333,
                description: 'am 16.03.2025',
                image: 'aktionen/2025-03-16.jpeg'
            },
            {
                name: 'B√ºrgerpark Parkplatz',
                lat: 49.888259,
                lng: 8.660894,
                description: 'am 15.06.2025',
                image: 'aktionen/2025-06-15.jpeg'
            },
            {
                name: 'Arheilgen Rodgaustra√üe',
                lat: 49.91296943400184,
                lng: 8.67082876382558,
                description: 'am 31.08.2025',
                image: 'aktionen/2025-08-31.jpeg'
            },
            {
                name: 'Arheilgen Unterf√ºhrung',
                lat: 49.910175998239566,
                lng: 8.646766197838238,
                description: 'am 21.09.2025',
                image: 'aktionen/2025-09-21.jpeg'
            },
            {
                name: 'Drei Brunnen Quelle',
                lat: 49.87144843775874,
                lng: 8.68486769176618,
                description: 'am 12.10.2025',
                image: 'aktionen/2025-10-12.jpeg'
            },
            {
                name: 'Arheilgen Rodgaustra√üe',
                lat: 49.912800302111265,
                lng: 8.669544723535923,
                description: 'am 26.10.2025',
                image: 'aktionen/2025-10-26.jpeg'
            },
            {
                name: 'Forsthaus B√∂llenfalltor',
                lat: 49.8527722222222,
                lng: 8.67221388888889,
                description: 'am 16.11.2025',
                image: 'aktionen/2025-11-16.jpeg'
            },
            {
                name: 'Maulbeerallee (Arheilgen)',
                lat: 49.898123761457086,
                lng: 8.660985340889866,
                description: 'am 30.11.2025',
                image: 'aktionen/2025-11-30.jpeg'
            },
            {
                name: 'Pfannm√ºllerweg',
                lat: 49.89441866817949,
                lng: 8.681245355254351,
                description: 'am 18.05.2025'
            },
            {
                name: 'Oberwaldhaus Parkplatz Ost',
                lat: 49.892503605373776,
                lng: 8.702181537666688,
                description: 'am 27.04.2025',
                image: 'aktionen/2025-04-27.jpeg'
            },
            {
                name: 'Br√ºcke √ºber B26',
                lat: 49.8664482068514,
                lng: 8.695790125258684,
                description: 'am 13.04.2025',
                image: 'aktionen/2025-04-13.jpeg'
            },
            {
                name: 'Kranichstein',
                lat: 49.898097131217035,
                lng: 8.680875193987644,
                description: 'am 30.03.2025'
            },
            {
                name: 'Marienplatz',
                lat: 49.8675656920946,
                lng: 8.645781399419167,
                description: 'am 02.03.2025',
                image: 'aktionen/2025-03-02.jpeg'
            },
            {
                name: 'Dornheimer Weg',
                lat: 49.8765319618606,
                lng: 8.605044506838885,
                description: 'am 09.02.2025',
                image: 'aktionen/2025-02-09.jpeg'
            }
        ];

        // Helper function to parse date from description and determine if event is completed
        function isEventCompleted(description) {
            const dateMatch = description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
            if (!dateMatch) return false;
            
            const [_, day, month, year] = dateMatch;
            // Event switches to completed at 12:00 on the event day
            const eventDate = new Date(year, month - 1, day, 12, 0, 0);
            const now = new Date();
            
            return now >= eventDate;
        }

        // Helper function to generate iCalendar file
        function generateICS(event, day, month, year) {
            const startDate = new Date(year, month - 1, day, 10, 30);
            const endDate = new Date(year, month - 1, day, 12, 0);
            
            // Format dates to iCalendar format (YYYYMMDDTHHMMSS)
            const formatICSDate = (date) => {
                const pad = (n) => n.toString().padStart(2, '0');
                return `${date.getFullYear()}${pad(date.getMonth() + 1)}${pad(date.getDate())}T${pad(date.getHours())}${pad(date.getMinutes())}00`;
            };
            
            // Build description with links only if coordinates are available
            let description = 'Cleanup-Aktion der Cleanup Gruppe Darmstadt';
            let geoField = '';
            
            if (event.lat && event.lng) {
                const osmUrl = `https://www.openstreetmap.org/?mlat=${event.lat}&mlon=${event.lng}&zoom=17`;
                const googleMapsUrl = `https://www.google.com/maps?q=${event.lat},${event.lng}`;
                description += `\\n\\nTreffpunkt:\\nOpenStreetMap: ${osmUrl}\\nGoogle Maps: ${googleMapsUrl}`;
                geoField = `GEO:${event.lat};${event.lng}`;
            }
            
            const icsContent = [
                'BEGIN:VCALENDAR',
                'VERSION:2.0',
                'PRODID:-//Cleanup Darmstadt//DE',
                'BEGIN:VEVENT',
                `DTSTART:${formatICSDate(startDate)}`,
                `DTEND:${formatICSDate(endDate)}`,
                `SUMMARY:Cleanup Darmstadt - ${event.name}`,
                `LOCATION:${event.name}`,
                geoField,
                `DESCRIPTION:${description}`,
                'END:VEVENT',
                'END:VCALENDAR'
            ].filter(line => line).join('\r\n');
            
            return 'data:text/calendar;charset=utf-8,' + encodeURIComponent(icsContent);
        }

        // Custom icons for different marker types
        const greenIcon = L.icon({
            iconUrl: 'images/marker-icon-green.png',
            shadowUrl: 'images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        const yellowIcon = L.icon({
            iconUrl: 'images/marker-icon-yellow.png',
            shadowUrl: 'images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        // Create marker cluster groups
        const completedMarkers = L.markerClusterGroup({
            iconCreateFunction: function(cluster) {
                const count = cluster.getChildCount();
                return L.divIcon({
                    html: '<div style="background-color: #28a745; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">' + count + '</div>',
                    className: 'custom-cluster-icon',
                    iconSize: L.point(40, 40)
                });
            },
            spiderfyOnMaxZoom: true,
            showCoverageOnHover: false,
            zoomToBoundsOnClick: true,
            maxClusterRadius: 50
        });

        // Add markers only for completed locations
        cleanupLocations.forEach(location => {
            // Skip locations without coordinates or future events
            if (!location.lat || !location.lng || !isEventCompleted(location.description)) return;
            
            const marker = L.marker([location.lat, location.lng], { icon: greenIcon });
            
            const popupContent = `
                <div style="font-family: sans-serif; max-width: 280px;">
                    ${location.name ? `<h3 style="font-weight: bold; color: #28a745; margin-bottom: 5px;">${location.name}</h3>` : ''}
                    <p style="margin: 0; font-size: 14px;">${location.description}</p>
                    ${location.image ? `<img src="${location.image}" alt="Cleanup Foto" loading="lazy" style="width: 280px; margin-top: 10px; border-radius: 4px;">` : ''}
                </div>
            `;
            
            marker.bindPopup(popupContent, {
                minWidth: 280,
                maxWidth: 300
            });

            completedMarkers.addLayer(marker);
        });

        // Add cluster group to map
        map.addLayer(completedMarkers);

        // Update next events list from planned locations
        const plannedEvents = cleanupLocations
            .filter(loc => !isEventCompleted(loc.description))
            .sort((a, b) => {
                // Parse dates from description (format: "am 14.12.2025")
                const dateMatchA = a.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                const dateMatchB = b.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                
                if (dateMatchA && dateMatchB) {
                    const dateA = new Date(dateMatchA[3], dateMatchA[2] - 1, dateMatchA[1]);
                    const dateB = new Date(dateMatchB[3], dateMatchB[2] - 1, dateMatchB[1]);
                    return dateA - dateB;
                }
                return 0;
            });
        
        const eventsListElement = document.getElementById('events-list');
        
        if (plannedEvents.length > 0) {
            plannedEvents.forEach(event => {
                // Parse date from description (format: "am 14.12.2025")
                const dateMatch = event.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                if (dateMatch) {
                    const [_, day, month, year] = dateMatch;
                    const date = new Date(year, month - 1, day);
                    const weekdays = ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'];
                    const months = ['Januar', 'Februar', 'M√§rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];
                    
                    const formattedDate = `${weekdays[date.getDay()]}, ${day}. ${months[date.getMonth()]} ${year}`;
                    
                    // Build map links HTML only if coordinates are available
                    let mapLinksHtml = '';
                    if (event.lat && event.lng) {
                        const osmLink = `https://www.openstreetmap.org/?mlat=${event.lat}&mlon=${event.lng}&zoom=17`;
                        const googleMapsLink = `https://www.google.com/maps?q=${event.lat},${event.lng}`;
                        const icsLink = generateICS(event, day, month, year);
                        mapLinksHtml = `
                            <a href="${osmLink}" target="_blank" class="text-yellow-300 hover:text-yellow-100 underline">üó∫Ô∏è OpenStreetMap</a>
                            <span class="text-white/50 mx-2">‚Ä¢</span>
                            <a href="${googleMapsLink}" target="_blank" class="text-yellow-300 hover:text-yellow-100 underline">üó∫Ô∏è Google Maps</a>
                            <span class="text-white/50 mx-2">‚Ä¢</span>
                            <a href="${icsLink}" download="cleanup-darmstadt-${day}-${month}-${year}.ics" class="text-yellow-300 hover:text-yellow-100 underline">üìÖ Kalender</a>
                        `;
                    }
                    
                    const eventCard = document.createElement('div');
                    eventCard.className = 'bg-white/20 rounded-lg p-6';
                    eventCard.innerHTML = `
                        <div class="text-center mb-4">
                            <p class="text-2xl font-bold mb-2">${formattedDate}</p>
                            <p class="text-xl">10:30 Uhr bis ca. 12:00 Uhr</p>
                        </div>
                        <p class="text-lg">
                            <strong>üìç Treffpunkt:</strong> ${event.name}
                        </p>
                        ${mapLinksHtml ? `<p class="text-base mt-2">${mapLinksHtml}</p>` : ''}
                    `;
                    eventsListElement.appendChild(eventCard);
                }
            });
        } else {
            eventsListElement.innerHTML = '<p class="text-center text-lg">Aktuell sind keine Termine geplant. Schau bald wieder vorbei!</p>';
        }
        
        // Populate list view with completed cleanups
        function populateListView() {
            const listContainer = document.getElementById('cleanup-list');
            const completedLocations = cleanupLocations
                .filter(loc => isEventCompleted(loc.description))
                .sort((a, b) => {
                    const dateMatchA = a.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                    const dateMatchB = b.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                    
                    if (dateMatchA && dateMatchB) {
                        const dateA = new Date(dateMatchA[3], dateMatchA[2] - 1, dateMatchA[1]);
                        const dateB = new Date(dateMatchB[3], dateMatchB[2] - 1, dateMatchB[1]);
                        return dateB - dateA; // Newest first
                    }
                    return 0;
                });
            
            if (completedLocations.length > 0) {
                listContainer.innerHTML = '';
                completedLocations.forEach(location => {
                    const dateMatch = location.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                    if (dateMatch) {
                        const [_, day, month, year] = dateMatch;
                        const date = new Date(year, month - 1, day);
                        const weekdays = ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'];
                        const months = ['Januar', 'Februar', 'M√§rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];
                        
                        const formattedDate = `${weekdays[date.getDay()]}, ${day}. ${months[date.getMonth()]} ${year}`;
                        
                        // Build map links HTML only if coordinates are available
                        let mapLinksHtml = '';
                        if (location.lat && location.lng) {
                            const osmLink = `https://www.openstreetmap.org/?mlat=${location.lat}&mlon=${location.lng}&zoom=17`;
                            const googleMapsLink = `https://www.google.com/maps?q=${location.lat},${location.lng}`;
                            mapLinksHtml = `
                                <div class="flex gap-3 text-sm flex-wrap">
                                    <a href="${osmLink}" target="_blank" class="text-primary hover:text-green-700 underline">üó∫Ô∏è OpenStreetMap</a>
                                    <a href="${googleMapsLink}" target="_blank" class="text-primary hover:text-green-700 underline">üó∫Ô∏è Google Maps</a>
                                    <button onclick="showOnMap(${location.lat}, ${location.lng})" class="text-primary hover:text-green-700 underline">üìç Auf Karte zeigen</button>
                                </div>
                            `;
                        }
                        
                        const listItem = document.createElement('div');
                        listItem.className = 'bg-gray-50 rounded-lg p-4 hover:shadow-md transition';
                        listItem.innerHTML = `
                            <div class="flex flex-col md:flex-row gap-4">
                                ${location.image ? `
                                    <div class="md:w-48 flex-shrink-0">
                                        <img src="${location.image}" alt="Cleanup Foto" loading="lazy" class="w-full h-32 object-cover rounded-lg">
                                    </div>
                                ` : ''}
                                <div class="flex-grow">
                                    <h3 class="font-bold text-lg text-primary mb-1">${location.name || 'Cleanup-Aktion'}</h3>
                                    <p class="text-gray-600 mb-2">${formattedDate}</p>
                                    ${mapLinksHtml}
                                </div>
                            </div>
                        `;
                        listContainer.appendChild(listItem);
                    }
                });
                
                // Add note about earlier actions
                const noteElement = document.createElement('div');
                noteElement.className = 'bg-blue-50 border-l-4 border-blue-500 p-4 mt-6 rounded-lg';
                noteElement.innerHTML = `
                    <p class="text-blue-800">
                        ‚ÑπÔ∏è Die Cleanup Gruppe Darmstadt ist seit einigen Jahren aktiv. Fr√ºhere Aktionen sind hier nicht n√§her aufgef√ºhrt.
                    </p>
                `;
                listContainer.appendChild(noteElement);
            } else {
                listContainer.innerHTML = '<p class="text-center text-gray-500">Keine abgeschlossenen Aktionen vorhanden.</p>';
            }
        }
        
        // Function to show location on map and switch to map view
        window.showOnMap = function(lat, lng) {
            // Switch to map tab
            document.getElementById('tab-map').click();
            
            // Center map and zoom
            map.setView([lat, lng], 16);
            
            // Scroll to map section
            document.getElementById('map-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        
        // Initialize list view
        populateListView();
    </script>
    
    <!-- Tab Switching Script -->
    <script>
        const tabMap = document.getElementById('tab-map');
        const tabList = document.getElementById('tab-list');
        const viewMap = document.getElementById('view-map');
        const viewList = document.getElementById('view-list');
        
        tabMap.addEventListener('click', () => {
            // Update tabs
            tabMap.classList.add('active', 'text-primary', 'border-primary');
            tabMap.classList.remove('text-gray-600', 'border-transparent');
            tabList.classList.remove('active', 'text-primary', 'border-primary');
            tabList.classList.add('text-gray-600', 'border-transparent');
            
            // Update views
            viewMap.classList.remove('hidden');
            viewList.classList.add('hidden');
            
            // Invalidate map size (Leaflet needs this after visibility change)
            setTimeout(() => map.invalidateSize(), 100);
        });
        
        tabList.addEventListener('click', () => {
            // Update tabs
            tabList.classList.add('active', 'text-primary', 'border-primary');
            tabList.classList.remove('text-gray-600', 'border-transparent');
            tabMap.classList.remove('active', 'text-primary', 'border-primary');
            tabMap.classList.add('text-gray-600', 'border-transparent');
            
            // Update views
            viewList.classList.remove('hidden');
            viewMap.classList.add('hidden');
        });
    </script>
    
    <!-- Mobile Menu & Scroll-to-Top Script -->
    <script>
        // Mobile Menu Toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            mobileMenu.classList.toggle('flex');
        });
        
        // Close mobile menu when clicking on a link
        const mobileLinks = mobileMenu.querySelectorAll('a');
        mobileLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
                mobileMenu.classList.remove('flex');
            });
        });
        
        // Scroll to Top Button
        const scrollBtn = document.getElementById('scroll-to-top');
        
        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                scrollBtn.classList.remove('opacity-0', 'invisible');
                scrollBtn.classList.add('opacity-100', 'visible');
            } else {
                scrollBtn.classList.add('opacity-0', 'invisible');
                scrollBtn.classList.remove('opacity-100', 'visible');
            }
        });
        
        scrollBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
    
    <!-- Scroll to Top Button -->
    <button id="scroll-to-top"
            class="fixed bottom-6 right-6 bg-primary text-white p-3 rounded-full shadow-lg hover:bg-green-600 transition opacity-0 invisible z-40"
            aria-label="Nach oben scrollen">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
        </svg>
    </button>
    
    <!-- Footer with Datenschutz & Impressum -->
    <footer class="bg-gray-800 text-gray-300 py-8">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Impressum -->
                <div>
                    <h3 class="text-lg font-bold text-white mb-3">Impressum</h3>
                    <p class="text-sm">
                        Verantwortlich: Birgit Haase<br>
                        Wittichstra√üe 2<br>
                        64295 Darmstadt<br>
                        E-Mail: birgit [at] cleanup-darmstadt.de
                    </p>
                </div>
                
                <!-- Datenschutz -->
                <div>
                    <h3 class="text-lg font-bold text-white mb-3">Datenschutz</h3>
                    <div class="text-sm space-y-3">
                        <div>
                            <strong class="text-white">Verantwortliche Stelle:</strong><br>
                            Cleanup Darmstadt<br>
                            E-Mail: birgit [at] cleanup-darmstadt.de
                        </div>
                        
                        <div>
                            <strong class="text-white">Erfassung personenbezogener Daten:</strong><br>
                            Beim Besuch dieser Website werden nur technisch notwendige Daten wie IP-Adresse, Datum/Uhrzeit, aufgerufene Datei und Browsertyp gespeichert. Diese Daten werden nicht weitergegeben und dienen ausschlie√ülich der Bereitstellung der Website.
                        </div>
                        
                        <div>
                            <strong class="text-white">Eingebundene Dienste:</strong><br>
                            Die Karte wird √ºber OpenStreetMap bereitgestellt. Dabei k√∂nnen technische Daten wie Ihre IP-Adresse an OpenStreetMap-Server √ºbermittelt werden. Weitere Infos: <a href="https://wiki.osmfoundation.org/wiki/Privacy_Policy" target="_blank" class="text-primary hover:text-green-400 underline">OpenStreetMap Privacy Policy</a>
                        </div>
                        
                        <div>
                            <strong class="text-white">Kontakt per E-Mail:</strong><br>
                            Ihre Daten werden nur zur Bearbeitung Ihrer Anfrage genutzt und anschlie√üend gel√∂scht.
                        </div>
                        
                        <div>
                            <strong class="text-white">Cookies/Tracking:</strong><br>
                            Es werden keine Cookies, Tracking- oder Analyse-Tools eingesetzt.
                        </div>
                        
                        <div>
                            <strong class="text-white">Ihre Rechte:</strong><br>
                            Sie haben jederzeit das Recht auf Auskunft, Berichtigung, L√∂schung, Einschr√§nkung der Verarbeitung, Widerspruch und Daten√ºbertragbarkeit.
                            Bei Fragen wenden Sie sich bitte per E-Mail an uns. Sie haben au√üerdem das Recht, sich bei der zust√§ndigen Aufsichtsbeh√∂rde zu beschweren.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="text-center mt-6 pt-6 border-t border-gray-700 text-sm">
                <p>&copy; 2025 Cleanup Gruppe Darmstadt</p>
                <p class="mt-2 text-gray-400">
                    Website erstellt von <a href="https://moritzmair.de/" target="_blank" class="text-primary hover:text-green-400 transition">moritzmair.de</a>
                </p>
            </div>
        </div>
    </footer>

</body>
</html>