<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanup Gruppe Darmstadt</title>
    <link rel="icon" type="image/png" href="images/cleanup_darmstadt.png">
    
    <!-- Tailwind CSS (lokal) -->
    <script src="tailwind.js"></script>
    
    <!-- Leaflet CSS (lokal) -->
    <link rel="stylesheet" href="leaflet.css" />
    <!-- Leaflet MarkerCluster CSS (lokal) -->
    <link rel="stylesheet" href="MarkerCluster.css" />
    <link rel="stylesheet" href="MarkerCluster.Default.css" />
</head>
<body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8">
        <!-- About Section -->
        <section class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold text-primary border-b-4 border-primary pb-2 mb-6 text-center">Wer wir sind</h2>
            <div class="max-w-3xl mx-auto text-gray-700 space-y-5">
                <p class="text-xl text-center font-medium text-primary">
                    Gemeinsam anpacken statt nur reden ‚Äì das ist unser Motto!
                </p>
                <p class="text-lg">
                    Wir sind eine Gruppe von <strong>Freiwilligen aus Darmstadt</strong>, die keine Lust mehr haben,
                    tatenlos zuzusehen, wie unsere sch√∂ne Natur verm√ºllt wird. Stattdessen krempeln wir die √Ñrmel hoch
                    und r√§umen auf ‚Äì ganz unkompliziert und ohne gro√ües Tamtam.
                </p>
                <p>
                    <strong>Jeden zweiten bis vierten Sonntag</strong> starten wir eine neue Cleanup-Aktion.
                    Wo genau? Das besprechen wir gemeinsam ‚Äì flexibel und nach Bedarf. Dabei geht es nicht nur
                    darum, M√ºlls√§cke zu f√ºllen. Es geht darum, <strong>zusammen etwas Sinnvolles zu tun</strong>,
                    nette Menschen kennenzulernen und die Gewissheit zu haben: Heute haben wir wirklich etwas bewegt!
                </p>
                <p>
                    Nach jedem Cleanup melden wir den gesammelten M√ºll der Stadt Darmstadt. Der
                    <strong>EAD</strong> k√ºmmert sich dann um die fachgerechte Entsorgung ‚Äì so bleibt unser
                    Einsatz nachhaltig und professionell.
                </p>
                <div class="bg-green-50 border-l-4 border-green-500 p-4 mt-6">
                    <p class="text-green-800 font-medium">
                        üíö Du brauchst keine Vorkenntnisse, keine spezielle Ausr√ºstung und keine langfristige Verpflichtung.
                        Komm einfach vorbei, wenn es bei dir passt ‚Äì jede helfende Hand z√§hlt!
                    </p>
                </div>
            </div>
        </section>

        <!-- Next Events Section -->
        <section id="next-events" class="bg-gray-800 text-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold mb-6 text-center">üóìÔ∏è N√§chste Termine</h2>
            <div class="max-w-3xl mx-auto">
                <div id="events-list" class="space-y-4 mb-6"></div>
                
                <div class="bg-white/10 rounded-lg p-4 italic">
                    <p class="text-center">
                        <strong>üåßÔ∏è Wichtiger Hinweis:</strong> Bei (starkem) Regen entf√§llt das Cleanup.
                        Dies wird am Vormittag kurzfristig entschieden.
                    </p>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section id="map-section" class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <!-- Map Container -->
            <div id="map" class="h-[800px] rounded-lg shadow-md mb-4"></div>
            
            <!-- Map Legend -->
            <div class="bg-gray-50 rounded-lg p-4">
                <h4 class="font-bold mb-3">Legende:</h4>
                <div class="flex flex-col gap-2">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-green-500 rounded-full text-white flex items-center justify-center font-bold shadow">5</div>
                        <span>Cluster mit mehreren durchgef√ºhrten Aktionen (Zahl zeigt Anzahl)</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <svg width="25" height="41" viewBox="0 0 25 41" class="flex-shrink-0">
                            <path fill="#28a745" d="M12.5 0C5.6 0 0 5.6 0 12.5c0 8.4 12.5 28.5 12.5 28.5S25 20.9 25 12.5C25 5.6 19.4 0 12.5 0z"/>
                            <circle cx="12.5" cy="12.5" r="5" fill="white"/>
                        </svg>
                        <span>Einzelne durchgef√ºhrte Cleanup-Aktion</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Info Section -->
        <section class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto">
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">üéí Was du mitbringen solltest</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>Feste Schuhe</li>
                        <li>Wetterfeste Kleidung</li>
                        <li>Gartenhandschuhe (falls vorhanden)</li>
                        <li>M√ºllzange (falls vorhanden)</li>
                        <li>ggf. Warnweste</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">‚úÖ Was wir bereitstellen</h4>
                    <ul class="list-disc list-inside space-y-2 text-gray-700">
                        <li>M√ºlls√§cke</li>
                        <li>Handschuhe (begrenzte Anzahl)</li>
                        <li>Cleanup Darmstadt Info Sticker</li>
                        <li>Organisation und Koordination</li>
                    </ul>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ F√ºr Familien geeignet</h4>
                    <p class="text-gray-700">
                        Unsere Cleanup-Aktionen sind familienfreundlich. Kinder sind willkommen und lernen
                        spielerisch den verantwortungsvollen Umgang mit der Umwelt.
                    </p>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-primary">
                    <h4 class="font-bold text-primary mb-3 text-xl">‚è±Ô∏è Zeitlicher Ablauf</h4>
                    <p class="text-gray-700">
                        Unsere Aktionen dauern in der Regel 1,5 Stunden. Du kannst jederzeit kommen und gehen,
                        wie es deine Zeit erlaubt.
                    </p>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section class="bg-white rounded-lg shadow-lg p-8 mb-8">
            <h2 class="text-3xl font-bold text-primary border-b-4 border-primary pb-2 mb-6 text-center">Kontakt</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üìò Facebook-Gruppe</h3>
                    <p class="mb-4 text-gray-700">Termine und Austausch</p>
                    <a href="https://www.facebook.com/groups/162624218009992" target="_blank"
                       class="text-primary font-semibold hover:underline">
                        Zur Facebook-Gruppe
                    </a>
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üì± WhatsApp-Gruppe</h3>
                    <p class="mb-4 text-gray-700">Schnelle Absprachen</p>
                    Beitritt auf Anfrage
                </div>
                <div class="bg-gray-50 p-6 rounded-lg text-center hover:shadow-lg transition">
                    <h3 class="text-xl font-bold text-primary mb-4">üìß E-Mail</h3>
                    <p class="mb-4 text-gray-700">Bei Fragen</p>
                    birgit [at] cleanup-darmstadt.de
                </div>
            </div>
        </section>
    </div>

    <!-- Leaflet JS (lokal) -->
    <script src="leaflet.js"></script>
    <!-- Leaflet MarkerCluster JS (lokal) -->
    <script src="leaflet.markercluster.js"></script>
    
    <!-- Map Script -->
    <script>
        // Initialize map centered on Darmstadt
        const map = L.map('map').setView([49.8728, 8.6512], 12);

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);

        // Define cleanup locations with coordinates
        const cleanupLocations = [
            {
                name: 'Ostbahnhof',
                lat: 49.874938,
                lng: 8.673340,
                type: 'planned',
                description: 'am 04.01.2026 um 10:30',
            },
            {
                name: 'B√ºrgerpark Parkplatz',
                lat: 49.888260847276264,
                lng: 8.660895854647498,
                type: 'planned',
                description: 'am 14.12.2025 um 10:30'
            },
            {
                name: '',
                lat: 49.8953277777778,
                lng: 8.63760555555556,
                type: 'completed',
                description: 'am 24.03.2024',
                image: 'aktionen/2024-03-24.jpeg'
            },
            {
                name: '',
                lat: 49.8882555555556,
                lng: 8.66094722222222,
                type: 'completed',
                description: 'am 14.07.2024',
                image: 'aktionen/2024-07-14.jpeg'
            },
            {
                name: '',
                lat: 49.8749277777778,
                lng: 8.67290277777778,
                type: 'completed',
                description: 'am 13.10.2024',
                image: 'aktionen/2024-10-13.jpeg'
            },
            {
                name: '',
                lat: 49.8921555555556,
                lng: 8.70035277777778,
                type: 'completed',
                description: 'am 19.01.2025',
                image: 'aktionen/2025-01-19.jpeg'
            },
            {
                name: '',
                lat: 49.8440777777778,
                lng: 8.64888333333333,
                type: 'completed',
                description: 'am 16.03.2025',
                image: 'aktionen/2025-03-16.jpeg'
            },
            {
                name: 'B√ºrgerpark Parkplatz',
                lat: 49.888259,
                lng: 8.660894,
                type: 'completed',
                description: 'am 15.06.2025',
                image: 'aktionen/2025-06-15.jpeg'
            },
            {
                name: 'Arheilgen Rodgaustra√üe',
                lat: 49.91296943400184,
                lng: 8.67082876382558,
                type: 'completed',
                description: 'am 31.08.2025',
                image: 'aktionen/2025-08-31.jpeg'
            },
            {
                name: 'Arheilgen Unterf√ºhrung',
                lat: 49.910175998239566,
                lng: 8.646766197838238,
                type: 'completed',
                description: 'am 21.09.2025',
                image: 'aktionen/2025-09-21.jpeg'
            },
            {
                name: 'Drei Brunnen Quelle',
                lat: 49.87144843775874,
                lng: 8.68486769176618,
                type: 'completed',
                description: 'am 12.10.2025',
                image: 'aktionen/2025-10-12.jpeg'
            },
            {
                name: 'Arheilgen Rodgaustra√üe',
                lat: 49.912800302111265,
                lng: 8.669544723535923,
                type: 'completed',
                description: 'am 26.10.2025',
                image: 'aktionen/2025-10-26.jpeg'
            },
            {
                name: 'Forsthaus B√∂llenfalltor',
                lat: 49.8527722222222,
                lng: 8.67221388888889,
                type: 'completed',
                description: 'am 16.11.2025',
                image: 'aktionen/2025-11-16.jpeg'
            },
            {
                name: 'Maulbeerallee (Arheilgen)',
                lat: 49.898123761457086,
                lng: 8.660985340889866,
                type: 'completed',
                description: 'am 30.11.2025',
                image: 'aktionen/2025-11-30.jpeg'
            },
            {
                name: 'Pfannm√ºllerweg',
                lat: 49.89441866817949,
                lng: 8.681245355254351,
                type: 'completed',
                description: 'am 18.05.2025'
            },
            {
                name: 'Oberwaldhaus Parkplatz Ost',
                lat: 49.892503605373776, 
                lng: 8.702181537666688,
                type: 'completed',
                description: 'am 27.04.2025'
            },
            {
                name: 'Br√ºcke √ºber B26',
                lat: 49.8664482068514,
                lng: 8.695790125258684,
                type: 'completed',
                description: 'am 13.04.2025'
            },
            {
                name: 'Kranichstein',
                lat: 49.898097131217035,
                lng: 8.680875193987644,
                type: 'completed',
                description: 'am 30.03.2025'
            },
            {
                name: 'Marienplatz',
                lat: 49.8675656920946,
                lng: 8.645781399419167,
                type: 'completed',
                description: 'am 02.03.2025',
                image: 'aktionen/2025-03-02.jpeg'
            },
            {
                name: 'Dornheimer Weg',
                lat: 49.8765319618606,
                lng: 8.605044506838885,
                type: 'completed',
                description: 'am 09.02.2025'
            }
        ];

        // Custom icons for different marker types
        const greenIcon = L.icon({
            iconUrl: 'images/marker-icon-green.png',
            shadowUrl: 'images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        const yellowIcon = L.icon({
            iconUrl: 'images/marker-icon-yellow.png',
            shadowUrl: 'images/marker-shadow.png',
            iconSize: [25, 41],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            shadowSize: [41, 41]
        });

        // Create marker cluster groups
        const completedMarkers = L.markerClusterGroup({
            iconCreateFunction: function(cluster) {
                const count = cluster.getChildCount();
                return L.divIcon({
                    html: '<div style="background-color: #28a745; color: white; border-radius: 50%; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 3px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);">' + count + '</div>',
                    className: 'custom-cluster-icon',
                    iconSize: L.point(40, 40)
                });
            },
            spiderfyOnMaxZoom: true,
            showCoverageOnHover: false,
            zoomToBoundsOnClick: true,
            maxClusterRadius: 50
        });

        // Add markers only for completed locations
        cleanupLocations.forEach(location => {
            // Skip locations without coordinates or planned events
            if (!location.lat || !location.lng || location.type === 'planned') return;
            
            const marker = L.marker([location.lat, location.lng], { icon: greenIcon });
            
            const popupContent = `
                <div style="font-family: sans-serif; max-width: 280px;">
                    ${location.name ? `<h3 style="font-weight: bold; color: #28a745; margin-bottom: 5px;">${location.name}</h3>` : ''}
                    <p style="margin: 0; font-size: 14px;">${location.description}</p>
                    ${location.image ? `<img src="${location.image}" alt="Cleanup Foto" style="width: 280px; margin-top: 10px; border-radius: 4px;">` : ''}
                </div>
            `;
            
            marker.bindPopup(popupContent, {
                minWidth: 280,
                maxWidth: 300
            });

            completedMarkers.addLayer(marker);
        });

        // Add cluster group to map
        map.addLayer(completedMarkers);

        // Update next events list from planned locations
        const plannedEvents = cleanupLocations
            .filter(loc => loc.type === 'planned')
            .sort((a, b) => {
                // Parse dates from description (format: "am 14.12.2025 um 10:30")
                const dateMatchA = a.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                const dateMatchB = b.description.match(/(\d{2})\.(\d{2})\.(\d{4})/);
                
                if (dateMatchA && dateMatchB) {
                    const dateA = new Date(dateMatchA[3], dateMatchA[2] - 1, dateMatchA[1]);
                    const dateB = new Date(dateMatchB[3], dateMatchB[2] - 1, dateMatchB[1]);
                    return dateA - dateB;
                }
                return 0;
            });
        
        const eventsListElement = document.getElementById('events-list');
        
        if (plannedEvents.length > 0) {
            plannedEvents.forEach(event => {
                // Parse date from description (format: "am 14.12.2025 um 10:30")
                const dateMatch = event.description.match(/(\d{2})\.(\d{2})\.(\d{4})\s+um\s+(\d{2}:\d{2})/);
                if (dateMatch) {
                    const [_, day, month, year, time] = dateMatch;
                    const date = new Date(year, month - 1, day);
                    const weekdays = ['Sonntag', 'Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag'];
                    const months = ['Januar', 'Februar', 'M√§rz', 'April', 'Mai', 'Juni', 'Juli', 'August', 'September', 'Oktober', 'November', 'Dezember'];
                    
                    const formattedDate = `${weekdays[date.getDay()]}, ${day}. ${months[date.getMonth()]} ${year}`;
                    const osmLink = `https://www.openstreetmap.org/?mlat=${event.lat}&mlon=${event.lng}&zoom=17`;
                    
                    const eventCard = document.createElement('div');
                    eventCard.className = 'bg-white/20 rounded-lg p-6';
                    eventCard.innerHTML = `
                        <div class="text-center mb-4">
                            <p class="text-2xl font-bold mb-2">${formattedDate}</p>
                            <p class="text-xl">${time} Uhr bis ca. 12:00 Uhr</p>
                        </div>
                        <p class="text-lg">
                            <strong>üìç Treffpunkt:</strong> ${event.name}
                            <a href="${osmLink}" target="_blank" class="text-yellow-300 hover:text-yellow-100 underline ml-2">üó∫Ô∏è Karte √∂ffnen</a>
                        </p>
                    `;
                    eventsListElement.appendChild(eventCard);
                }
            });
        } else {
            eventsListElement.innerHTML = '<p class="text-center text-lg">Aktuell sind keine Termine geplant. Schau bald wieder vorbei!</p>';
        }
    </script>
    <!-- Footer with Datenschutz & Impressum -->
    <footer class="bg-gray-800 text-gray-300 py-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                <!-- Impressum -->
                <div>
                    <h3 class="text-lg font-bold text-white mb-3">Impressum</h3>
                    <p class="text-sm">
                        Verantwortlich: Birgit Haase<br>
                        Wittichstra√üe 2<br>
                        64295 Darmstadt<br>
                        E-Mail: birgit [at] cleanup-darmstadt.de
                    </p>
                </div>
                
                <!-- Datenschutz -->
                <div>
                    <h3 class="text-lg font-bold text-white mb-3">Datenschutz</h3>
                    <p class="text-sm">
                        Diese Website verwendet keine Cookies und erfasst keine personenbezogenen Daten.
                        Die Karte wird √ºber OpenStreetMap bereitgestellt.
                        Kontaktanfragen per E-Mail werden nur zur Beantwortung Ihrer Anfrage verwendet.
                    </p>
                </div>
            </div>
            
            <div class="text-center mt-6 pt-6 border-t border-gray-700 text-sm">
                <p>&copy; 2025 Cleanup Gruppe Darmstadt</p>
            </div>
        </div>
    </footer>

</body>
</html>